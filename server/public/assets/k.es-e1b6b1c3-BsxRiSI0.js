var l,p,s;(function(e){e.momo="momo",e.card="card",e.wallet="wallet"})(l||(l={})),function(e){e.BJ="BJ",e.CI="CI",e.SN="SN",e.TG="TG",e.NE="NE"}(p||(p={})),function(e){e.NETWORK_STATE_CHANGED="NETWORK_STATE_CHANGED",e.INIT_WIDGET="INIT_WIDGET",e.WIDGET_SUCCESSFULLY_INIT="WIDGET_SUCCESSFULLY_INIT",e.CLOSE_WIDGET="CLOSE_WIDGET",e.DESTROY_WIDGET="DESTROY_WIDGET",e.WIDGET_SUCCESSFULLY_DESTROYED="WIDGET_SUCCESSFULLY_DESTROYED",e.PAYMENT_INIT="PAYMENT_INIT",e.PAYMENT_ABORTED="PAYMENT_ABORTED",e.PENDING_PAYMENT="PENDING_PAYMENT",e.ON_USER_FEEDBACK="ON_USER_FEEDBACK",e.PAYMENT_FAILED="PAYMENT_FAILED",e.PAYMENT_SUCCESS="PAYMENT_SUCCESS",e.PAYMENT_END="PAYMENT_END",e.RETRY_PAYMENT="RETRY_PAYMENT",e.WAVE_LINK="WAVE_LINK"}(s||(s={}));const I={},E={UI_APP_DEV:"https://widget-v3.kkiapay.me",UI_APP_CDN_LINK:"https://cdn.kkiapay.me/k.js"},_=["amount","sandbox","position","theme","paymentmethod","paymentMethods","providers","fullname","name","email","phoneNumber","phone","data","key","sdk","url","callback","successCallback","failed_callback","buttontext","direct","split","partnerid","partnerId","apikey","api_key","publicAPIKey","countries"],N={phone:"phoneNumber",name:"fullname",paymentmethod:"paymentMethods",apikey:"key",successCallback:"callback",publicAPIKey:"key",api_key:"key",partnerid:"partnerId"},y=["countries","paymentMethods"];function u(e){const n=e.split("-");return n[0]+n.slice(1).map(d=>d.charAt(0).toUpperCase()+d.slice(1)).join("")}function r(e){const n=JSON.parse(JSON.stringify(e));return n===""?n:Number.isNaN(Number(n))?n==="false"?!1:n==="true"?!0:n.indexOf(",")>-1?n.split(" ").join("").split(","):n:Number(n)}class A extends HTMLElement{constructor(){super();const n=this.attachShadow({mode:"open"});let d,t=document.createElement("button");t.innerHTML=window.navigator.language.split("-")[0]==="en"?"Pay now":"Payer maintenant",t.setAttribute("style",`
        background-color: #4661b9;
        color: white;
        padding: 10px 20px;
        font-size: 16px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      `),n.appendChild(t),setTimeout(()=>{d=Object.freeze({...this})},100),t.addEventListener("click",()=>{window.openKkiapayWidget(d)})}static get observedAttributes(){return _}attributeChangedCallback(n,d,t){if(d!==null||(this[u(n)]=t,!this.shadowRoot))return;const a=this.shadowRoot.querySelector("button");a&&(n===u("buttontext")&&t&&(a.innerHTML=t),n==="class"&&t&&a.setAttribute("class",t))}}let o,T=()=>{};const L=e=>{e=function(d){const t={...d};for(let a in N)t[a]&&(t[N[a]]=t[a],delete t[a]);for(let a in t){if(["data","paymentMethods","countries"].includes(a)){try{t[a]=JSON.parse(JSON.stringify(t[a]))}catch{}y.includes(a)&&(t[a]=Array.isArray(r(t[a]))?r(t[a]):[r(t[a])],a==="paymentMethods")&&t.paymentMethods.find(w=>!["momo","card","direct_debit"].includes(w))&&(t.paymentMethods=["momo","card","direct_debit"])}a==="amount"&&(t[a]=Number(t[a])),a==="phoneNumber"&&(t[a]=String(t[a])),a==="sandbox"&&typeof t.sandbox!="boolean"&&(t.sandbox==="true"?t.sandbox=!0:(t.sandbox,t.sandbox=!1)),a!=="position"||["left","right","center"].includes(t[a])||(t[a]="center")}return t}(e);const n=o.contentWindow;n&&n.postMessage({name:s.INIT_WIDGET,data:{...e,host:window.location.href,...I}},E.UI_APP_DEV)};(()=>{const e=new Date().getTime();o=document.createElement("iframe"),o.style.cssText=`
    display: block;
    height: 100dvh; 
    width: 100%; 
    position: fixed;
    top: 0;
    left: 0;
    z-index: ${e};`,o.src=E.UI_APP_DEV,o.setAttribute("frameborder","0"),o.addEventListener("load",()=>T())})();const m=e=>{T=()=>L(e),document.body.appendChild(o)},c=()=>o.remove(),S=e=>{var n;return(n=window.open(e,"_blank"))==null?void 0:n.focus()},i=(()=>{const e={[s.CLOSE_WIDGET]:c,[s.WAVE_LINK]:S};for(const n in s)e[n]||(e[n]=()=>{});return e})();window.addEventListener("load",()=>(()=>{const e=document.querySelector(".kkiapay-button"),n=document.querySelector(`script[src="${E.UI_APP_CDN_LINK}"]`);if(n&&e){let d={};for(let t of _){const a=n.getAttribute(t);a&&(d[t]=a)}e.addEventListener("click",()=>{m(d)})}})()),window.addEventListener("message",e=>{e.data&&i[e.data.name]&&i[e.data.name](e.data.data)});const b=e=>{i.INIT_WIDGET=e},D=e=>{i.CLOSE_WIDGET=()=>{c(),e()}},k=e=>{i.DESTROY_WIDGET=e},P=e=>{i.PAYMENT_INIT=e},h=e=>{i.PAYMENT_ABORTED=e},C=e=>{i.PENDING_PAYMENT=e},f=e=>{i.ON_USER_FEEDBACK=e},g=e=>{i.PAYMENT_SUCCESS=e},M=e=>{i.PAYMENT_FAILED=e},Y=e=>{i.PAYMENT_END=e},W=e=>{i.NETWORK_STATE_CHANGED=e},K=(e,n)=>{i[`PAYMENT_${e.toUpperCase()}`]=n},O=e=>{i[`PAYMENT_${e.toUpperCase()}`]=()=>{}};window.openKkiapayWidget=m,window.closeKkiapayWidget=c,window.addWidgetInitListener=b,window.addKkiapayCloseListener=D,window.addWidgetDestroyedListener=k,window.addPaymentInitListener=P,window.addPaymentEndListener=Y,window.addPaymentAbortedListener=h,window.addFeedbackListener=f,window.addPendingListener=C,window.addFailedListener=M,window.addSuccessListener=g,window.onNetworkStateChanged=W,window.addEventListener=addEventListener,window.addKkiapayListener=K,window.removeKkiapayListener=O,window.customElements.get("kkiapay-widget")||window.customElements.define("kkiapay-widget",A);export{s as ListenerEventName,M as addFailedListener,f as addFeedbackListener,D as addKkiapayCloseListener,K as addKkiapayListener,h as addPaymentAbortedListener,Y as addPaymentEndListener,P as addPaymentInitListener,C as addPendingListener,g as addSuccessListener,k as addWidgetDestroyedListener,b as addWidgetInitListener,c as closeKkiapayWidget,S as focusWaveLink,W as onNetworkStateChanged,m as openKkiapayWidget,O as removeKkiapayListener};
